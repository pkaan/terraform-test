trigger:
- none


stages:
 - stage: Prepare_Deploy_Terraform_IaC
   displayName: "Prepare and Deploy Terraform IaC"
   jobs:
   - job: Prepare_Terraform
     pool:
       name: pkaan-selfhost-pool
       vmImage: ubuntu-latest
     steps:
     - task: TerraformInstaller@0
       displayName: "Install Terraform"
       inputs:
         terraformVersion: 'latest'
     - script: |
         terraform init
       displayName: 'Terraform init'
     - script: |
         terraform plan -out=appservice.tfplan
       displayName: 'Terraform Plan'
     - script: |
         terraform import azurerm_resource_group.rg /subscriptions/4b9c23f1-02d5-4863-9c82-9fa1098c566d/resourceGroups/pkaan_terraform_group
       displayName: 'Terraform State'
     - script: |
         terraform apply appservice.tfplan
       displayName: 'Terraform Apply'